# vim: ft=yaml.ansible
---
- name: Check distro
  ansible.builtin.assert:
    quiet: true
    that:
      - ansible_facts['distribution'] == 'Archlinux'
      - ansible_facts['hostname'] == inventory_hostname

- name: Install python-kubernetes for Ansible
  become: true
  community.general.pacman:
    name: python-kubernetes
    state: present
    update_cache: true

- name: Setup subvolumes
  become: true
  ansible.builtin.import_tasks:
    file: 10-subvolumes.yml

- name: Setup k3s
  become: true
  ansible.builtin.import_tasks:
    file: 20-k3s.yml

- name: Setup kubectl
  become: true
  ansible.builtin.import_tasks:
    file: 30-kubectl.yml
